from database.MySQLManager import MySQLManager

__author__ = 'yukai'


class LiaoXueFengDirectorManager(MySQLManager):
    def create_director(self):
        if self.connection is not None:
            cursor = self.connection.cursor()
            cursor.execute(
                '''
                CREATE TABLE IF NOT EXISTS `liaoxuefeng_directory` (
                  `category_id` INT(11) UNSIGNED NOT NULL,
                  `parent_key` VARCHAR(100) NOT NULL DEFAULT '',
                  `sub_key` VARCHAR(100) NOT NULL DEFAULT '',
                  `is_parent` TINYINT(1) NOT NULL DEFAULT '1' COMMENT '是否是父层',
                  `title` VARCHAR(100) NOT NULL DEFAULT '',
                  `index` INT(11) NOT NULL AUTO_INCREMENT,
                  PRIMARY KEY (`category_id`,`parent_key`,`sub_key`),
                  KEY `index` (`index`)
                ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
                '''
            )
            self.connection.commit()
            cursor.close()

    def insert_into_director(self, *values):
        if self.connection is not None:
            cursor = self.connection.cursor()
            for value in values:
                cursor.execute(
                    '''
                    insert into `liaoxuefeng_directory` (`category_id`, `parent_key`, `sub_key`, `is_parent`, `title`)
                    VALUES (%s, %s, %s, %s, %s)
                    ''',
                    value)
            self.connection.commit()
            cursor.close()

    def fetch_from_director(self):
        if self.connection is not None:
            fetch_cursor = self.connection.cursor()
            fetch_cursor.execute("SELECT `category_id`, `parent_key`, `sub_key`, `is_parent`, `title`, `index` FROM"
                                 " `liaoxuefeng_directory` ORDER BY `index` ASC ")
            values = fetch_cursor.fetchall()
            fetch_cursor.close()
            return values


if __name__ == '__main__':
    sqlManager = LiaoXueFengDirectorManager()
    sqlManager.create_connection()
    sqlManager.create_director()
    aaa = [
        [9, '0014316089557264a6b348958f449949df42a6d3a2e542c000', '0014316089557264a6b348958f449949df42a6d3a2e542c000',
         1, 'Python教程'],
        [9, '001431608990315a01b575e2ab041168ff0df194698afac000', '001431608990315a01b575e2ab041168ff0df194698afac000',
         1, 'Python简介'],
        [9, '0014316090478912dab2a3a9e8f4ed49d28854b292f85bb000', '00143161198846783e33de56d4041058c3dfc7e44ee1203000',
         0, 'Python解释器'],
        [9, '001431611988455689d4c116b2c4ed6aec000776c00ed52000', '0014316399410395f704750ee9440228135925a6ca1dad8000',
         0, '使用文本编辑器'],
        [9, '001431611988455689d4c116b2c4ed6aec000776c00ed52000', '001432523496782e0946b0f454549c0888d05959b99860f000',
         0, 'Python代码运行助手'],
        [9, '001431611988455689d4c116b2c4ed6aec000776c00ed52000', '001431643484137e38b44e5925440ec8b1e4c70f800b4e2000',
         0, '输入和输出'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '001431658624177ea4f8fcb06bc4d0e8aab2fd7aa65dd95000',
         0, '数据类型和变量'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000',
         0, '字符串和编码'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '0014316724772904521142196b74a3f8abf93d8e97c6ee6000',
         0, '使用list和tuple'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '001431675624710bb20e9734ef343bbb4bd64bcd37d4b52000',
         0, '条件判断'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '001431676242561226b32a9ec624505bb8f723d0027b3e7000',
         0, '循环'],
        [9, '001431658427513eef3d9dd9f7c48599116735806328e81000', '00143167793538255adf33371774853a0ef943280573f4d000',
         0, '使用dict和set'],
        [9, '00143167832686474803d3d2b7d4d6499cfd093dc47efcd000', '0014316784721058975e02b46cc45cb836bb0827607738d000',
         0, '调用函数'],
        [9, '00143167832686474803d3d2b7d4d6499cfd093dc47efcd000', '001431679203477b5b364aeba8c4e05a9bd4ec1b32911e2000',
         0, '定义函数'],
        [9, '00143167832686474803d3d2b7d4d6499cfd093dc47efcd000', '001431752945034eb82ac80a3e64b9bb4929b16eeed1eb9000',
         0, '函数的参数'],
        [9, '00143167832686474803d3d2b7d4d6499cfd093dc47efcd000', '001431756044276a15558a759ec43de8e30eb0ed169fb11000',
         0, '递归函数'],
        [9, '0014317568446245b3e1c8837414168bcd2d485e553779e000', '001431756919644a792ee4ead724ef7afab3f7f771b04f5000',
         0, '切片'],
        [9, '0014317568446245b3e1c8837414168bcd2d485e553779e000', '0014317793224211f408912d9c04f2eac4d2af0d5d3d7b2000',
         0, '迭代'],
        [9, '0014317568446245b3e1c8837414168bcd2d485e553779e000', '001431779637539089fd627094a43a8a7c77e6102e3a811000',
         0, '列表生成式'],
        [9, '0014317568446245b3e1c8837414168bcd2d485e553779e000', '0014317799226173f45ce40636141b6abc8424e12b5fb27000',
         0, '生成器'],
        [9, '0014317568446245b3e1c8837414168bcd2d485e553779e000', '00143178254193589df9c612d2449618ea460e7a672a366000',
         0, '迭代器'],
        [9, '0014317848428125ae6aa24068b4c50a7e71501ab275d52000', '0014317849054170d563b13f0fa4ce6ba1cd86e18103f28000',
         0, '高阶函数'],
        [9, '0014317852443934a86aa5bb5ea47fbbd5f35282b331335000', '0014317852443934a86aa5bb5ea47fbbd5f35282b331335000',
         1, 'map/reduce'],
        [9, '001431821084171d2e0f22e7cc24305ae03aa0214d0ef29000', '001431821084171d2e0f22e7cc24305ae03aa0214d0ef29000',
         1, 'filter'],
        [9, '0014318230588782cac105d0d8a40c6b450a232748dc854000', '001431835236741e42daf5af6514f1a8917b8aaadff31bf000',
         0, '返回函数'],
        [9, '0014318230588782cac105d0d8a40c6b450a232748dc854000', '001431843456408652233b88b424613aa8ec2fe032fd85a000',
         0, '匿名函数'],
        [9, '0014318230588782cac105d0d8a40c6b450a232748dc854000', '0014318435599930270c0381a3b44db991cd6d858064ac0000',
         0, '装饰器'],
        [9, '0014318230588782cac105d0d8a40c6b450a232748dc854000', '00143184474383175eeea92a8b0439fab7b392a8a32f8fa000',
         0, '偏函数'],
        [9, '0014318447437605e90206e261744c08630a836851f5183000', '001431845183474e20ee7e7828b47f7b7607f2dc1e90dbb000',
         0, '使用模块'],
        [9, '0014318447437605e90206e261744c08630a836851f5183000', '00143186362353505516c5d4e38456fb225c18cc5b54ffb000',
         0, '安装第三方模块'],
        [9, '0014318645694388f1f10473d7f416e9291616be8367ab5000', '001431864715651c99511036d884cf1b399e65ae0d27f7e000',
         0, '类和实例'],
        [9, '0014318645694388f1f10473d7f416e9291616be8367ab5000', '0014318650247930b1b21d7d3c64fe38c4b5a80d4469ad7000',
         0, '访问限制'],
        [9, '0014318645694388f1f10473d7f416e9291616be8367ab5000', '001431865288798deef438d865e4c2985acff7e9fad15e3000',
         0, '继承和多态'],
        [9, '0014318645694388f1f10473d7f416e9291616be8367ab5000', '001431866385235335917b66049448ab14a499afd5b24db000',
         0, '获取对象信息'],
        [9, '0014318645694388f1f10473d7f416e9291616be8367ab5000', '0014319117128404c7dd0cf0e3c4d88acc8fe4d2c163625000',
         0, '实例属性和类属性'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '00143186739713011a09b63dcbd42cc87f907a778b3ac73000',
         0, '使用__slots__'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '00143186781871161bc8d6497004764b398401a401d4cce000',
         0, '使用@property'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '0014318680104044a55f4a9dbf8452caf71e8dc68b75a18000',
         0, '多重继承'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '0014319098638265527beb24f7840aa97de564ccc7f20f6000',
         0, '定制类'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '00143191235886950998592cd3e426e91687cdae696e64b000',
         0, '使用枚举类'],
        [9, '00143186738532805c392f2cc09446caf3236c34e3f980f000', '0014319106919344c4ef8b1e04c48778bb45796e0335839000',
         0, '使用元类'],
        [9, '001431913726557e5e43e1ee8d54ee486bddc3f607afb75000', '00143191375461417a222c54b7e4d65b258f491c093a515000',
         0, '错误处理'],
        [9, '001431913726557e5e43e1ee8d54ee486bddc3f607afb75000', '001431915578556ad30ab3933ae4e82a03ee2e9a4f70871000',
         0, '调试'],
        [9, '001431913726557e5e43e1ee8d54ee486bddc3f607afb75000', '00143191629979802b566644aa84656b50cd484ec4a7838000',
         0, '单元测试'],
        [9, '001431913726557e5e43e1ee8d54ee486bddc3f607afb75000', '0014319170285543a4d04751f8846908770660de849f285000',
         0, '文档测试'],
        [9, '001431917590955542f9ac5f5c1479faf787ff2b028ab47000', '001431917715991ef1ebc19d15a4afdace1169a464eecc2000',
         0, '文件读写'],
        [9, '001431917590955542f9ac5f5c1479faf787ff2b028ab47000', '001431918785710e86a1a120ce04925bae155012c7fc71e000',
         0, 'StringIO和BytesIO'],
        [9, '001431917590955542f9ac5f5c1479faf787ff2b028ab47000', '001431925324119bac1bc7979664b4fa9843c0e5fcdcf1e000',
         0, '操作文件和目录'],
        [9, '001431917590955542f9ac5f5c1479faf787ff2b028ab47000', '00143192607210600a668b5112e4a979dd20e4661cc9c97000',
         0, '序列化'],
        [9, '0014319272686365ec7ceaeca33428c914edf8f70cca383000', '001431927781401bb47ccf187b24c3b955157bb12c5882d000',
         0, '多进程'],
        [9, '0014319272686365ec7ceaeca33428c914edf8f70cca383000', '00143192823818768cd506abbc94eb5916192364506fa5d000',
         0, '多线程'],
        [9, '0014319272686365ec7ceaeca33428c914edf8f70cca383000', '001431928972981094a382e5584413fa040b46d46cce48e000',
         0, 'ThreadLocal'],
        [9, '0014319272686365ec7ceaeca33428c914edf8f70cca383000', '0014319292979766bd3285c9d6b4942a8ea9b4e9cfb48d8000',
         0, '进程 vs. 线程'],
        [9, '0014319272686365ec7ceaeca33428c914edf8f70cca383000', '001431929340191970154d52b9d484b88a7b343708fcc60000',
         0, '分布式进程'],
        [9, '00143193331387014ccd1040c814dee8b2164bb4f064cff000', '00143193331387014ccd1040c814dee8b2164bb4f064cff000',
         1, '正则表达式'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001431937554888869fb52b812243dda6103214cd61d0c2000',
         0, 'datetime'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001431953239820157155d21c494e5786fce303f3018c86000',
         0, 'collections'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001431954588961d6b6f51000ca4279a3415ce14ed9d709000',
         0, 'base64'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001431955007656a66f831e208e4c189b8a9e9f3f25ba53000',
         0, 'struct'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '0014319556588648dd1fb0047a34d0c945ee33e8f4c90cc000',
         0, 'hashlib'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '00143200162233153835cfdd1a541a18ddc15059e3ddeec000',
         0, 'itertools'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001432002075057b594f70ecb58445da6ef6071aca880af000',
         0, 'XML'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '0014320023122880232500da9dc4a4486ad00426f081c15000',
         0, 'HTMLParser'],
        [9, '0014319347182373b696e637cc04430b8ee2d548ca1b36d000', '001432688314740a0aed473a39f47b09c8c7274c9ab6aee000',
         0, 'urllib'],
        [9, '001432002680493d1babda364904ca0a6e28374498d59a7000', '0014320027235877860c87af5544f25a8deeb55141d60c5000',
         0, 'PIL'],
        [9, '001432712108300322c61f256c74803b43bfd65c6f8d0d0000', '001432712108300322c61f256c74803b43bfd65c6f8d0d0000',
         1, 'virtualenv'],
        [9, '00143200341926302f99cf6f6414dca9dfaaf6e5a25a5b1000', '00143200341926302f99cf6f6414dca9dfaaf6e5a25a5b1000',
         1, '图形界面'],
        [9, '0014320037274136d31bd9979d648cd822375394e29a871000', '0014320037768360d53e4e935ca4a1f96eed1c896ad1217000',
         0, 'TCP/IP简介'],
        [9, '0014320037274136d31bd9979d648cd822375394e29a871000', '001432004374523e495f640612f4b08975398796939ec3c000',
         0, 'TCP编程'],
        [9, '0014320037274136d31bd9979d648cd822375394e29a871000', '001432004977916a212e2168e21449981ad65cd16e71201000',
         0, 'UDP编程'],
        [9, '001432005156604f38836be1707453eb025ce8c3079978d000', '001432005226355aadb8d4b2f3f42f6b1d6f2c5bd8d5263000',
         0, 'SMTP发送邮件'],
        [9, '001432005156604f38836be1707453eb025ce8c3079978d000', '0014320098721191b70a2cf7b5441deb01595edd8147196000',
         0, 'POP3收取邮件'],
        [9, '001432010325987131e75bf6b3543429a2975f88ce8ffa9000', '001432010494717e1db78cd172e4d52b853e7fd38d6985c000',
         0, '使用SQLite'],
        [9, '001432010325987131e75bf6b3543429a2975f88ce8ffa9000', '0014320107391860b39da6901ed41a296e574ed37104752000',
         0, '使用MySQL'],
        [9, '001432010325987131e75bf6b3543429a2975f88ce8ffa9000', '0014320114981139589ac5f02944601ae22834e9c521415000',
         0, '使用SQLAlchemy'],
        [9, '0014320118765877e93ecea4e6449acb157e9efae8b40b6000', '001432011939547478fd5482deb47b08716557cc99764e0000',
         0, 'HTTP协议简介'],
        [9, '0014320118765877e93ecea4e6449acb157e9efae8b40b6000', '0014320122322996f770fbf5da84ead84a1731e1dde129f000',
         0, 'HTML简介'],
        [9, '0014320118765877e93ecea4e6449acb157e9efae8b40b6000', '001432012393132788f71e0edad4676a3f76ac7776f3a16000',
         0, 'WSGI接口'],
        [9, '0014320118765877e93ecea4e6449acb157e9efae8b40b6000', '001432012745805707cb9f00a484d968c72dbb7cfc90b91000',
         0, '使用Web框架'],
        [9, '0014320118765877e93ecea4e6449acb157e9efae8b40b6000', '0014320129740415df73bf8f81e478982bf4d5c8aa3817a000',
         0, '使用模板'],
        [9, '00143208573480558080fa77514407cb23834c78c6c7309000', '001432090171191d05dae6e129940518d1d6cf6eeaaa969000',
         0, '协程'],
        [9, '00143208573480558080fa77514407cb23834c78c6c7309000', '001432090954004980bd351f2cd4cc18c9e6c06d855c498000',
         0, 'asyncio'],
        [9, '00143208573480558080fa77514407cb23834c78c6c7309000', '0014320981492785ba33cc96c524223b2ea4e444077708d000',
         0, 'aiohttp'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432170937506ecfb2f6adf8e4757939732f3e32b781c000',
         0, 'Day 1 - 搭建开发环境'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '00143217133614028a244ea855b40a586b551c616d3b2c9000',
         0, 'Day 2 - 编写Web App骨架'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '0014323389656575142d0bcfeec434e9639a80d3684a7da000',
         0, 'Day 3 - 编写ORM'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432338991719a4c5c42ef08e4f44ad0f293ad728a27b000',
         0, 'Day 4 - 编写Model'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339008728d0ddbe19ee594980be3f0644a9371894000',
         0, 'Day 5 - 编写Web框架'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339034336cbf72acd43354d72831461e3871d9f2e000',
         0, 'Day 6 - 编写配置文件'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339095180ce91c53cdab841bfa9c342a297b886fe000',
         0, 'Day 7 - 编写MVC'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339124159f00f6ab876c44349a3fd8eb26d0c291e000',
         0, 'Day 8 - 构建前端'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '0014323391480651a75b5fda4cb4c789208191682fc2c70000',
         0, 'Day 9 - 编写API'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339169382f45b9bd7b45d47ceb3e2b42846e0e991000',
         0, 'Day 10 - 用户注册和登录'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '00143233918656129f4ad3ac29e4f728dc72b5d2368215a000',
         0, 'Day 11 - 编写日志创建页'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339210950e063b4795d574036bc5dcf0c2449bc52000',
         0, 'Day 12 - 编写日志列表页'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339228196a8eb6fb8832b48b5aa0d740346536ead000',
         0, 'Day 13 - 提升开发效率'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339247097eea476bf61f8496092cc1b663eae1848000',
         0, 'Day 14 - 完成Web App'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '0014323392805925d5b69ddad514511bf0391fe2a0df2b0000',
         0, 'Day 15 - 部署Web App'],
        [9, '001432170876125c96f6cc10717484baea0c6da9bee2be4000', '001432339330096121ae7e38be44570b7fbd0d8faae26f6000',
         0, 'Day 16 - 编写移动App'],
        [9, '00143278155868605a65e244e6642dfa533753e6338ab5b000', '00143278155868605a65e244e6642dfa533753e6338ab5b000',
         1, 'FAQ'],
        [9, '0014323396477522f8ff26917934f53b49559ab4dc5eab2000', '0014323396477522f8ff26917934f53b49559ab4dc5eab2000',
         1, '期末总结']]
    sqlManager.insert_into_director(*aaa)
    print(sqlManager.fetch_from_director())
    sqlManager.close_conn()
